{"version":3,"file":"colorContrast.js","sources":["../../colorContrast.js"],"sourcesContent":["class ColorContrastChecker {\n\tconstructor(containerElement, criteriaInfo = { fontSize: \"23.994px\", fontWeight: 700, contrastThreshold: 4.5 }) {\n\t\tthis.containerElement = containerElement;\n\t\tthis.contrastThreshold = criteriaInfo.contrastThreshold;\n\t\tthis.criteriaInfo = criteriaInfo;\n\t\tif (!this.containerElement) {\n\t\t\tthrow new Error(`Container element with selector \"${containerSelector}\" not found.`);\n\t\t}\n\t}\n\n\tinit() {\n\t\tif (document.readyState === \"loading\") {\n\t\t\tdocument.addEventListener(\"DOMContentLoaded\", () => this.checkContrastForChildren());\n\t\t} else {\n\t\t\tthis.checkContrastForChildren();\n\t\t}\n\t}\n\n\tgetElementStyle(element) {\n\t\tconst style = window.getComputedStyle(element);\n\t\treturn {\n\t\t\tbgColor: style.backgroundColor,\n\t\t\tcolor: style.color,\n\t\t\tfontSize: style.fontSize,\n\t\t\tfontWeight: style.fontWeight,\n\t\t};\n\t}\n\n\tgetEffectiveBackgroundColor(element) {\n\t\tlet currentElement = element;\n\t\tlet bgColor;\n\n\t\twhile (currentElement && currentElement !== document.body) {\n\t\t\tbgColor = this.getElementStyle(currentElement).bgColor;\n\t\t\tif (!this.isTransparent(bgColor)) {\n\t\t\t\treturn bgColor;\n\t\t\t}\n\t\t\tcurrentElement = currentElement.parentElement;\n\t\t}\n\n\t\treturn this.getElementStyle(document.body).bgColor;\n\t}\n\n\tcheckContrastForChildren(element = this.containerElement) {\n\t\tconst children = element.children;\n\t\tfor (const child of children) {\n\t\t\tconst childStyle = this.getElementStyle(child);\n\t\t\tconst contrast = this.calculateContrastRatio(this.getEffectiveBackgroundColor(child), childStyle.color);\n\n\t\t\tlet isValid = false;\n\n\t\t\t// check whether the element matches the criteria or not\n\t\t\tconst isLargeFont = childStyle.fontSize <= this.criteriaInfo.fontSize;\n\t\t\tconst isBold = childStyle.fontWeight <= this.criteriaInfo.fontWeight;\n\t\t\tthis.contrastThreshold = isLargeFont && isBold ? 4.5 : 3.1;\n\n\t\t\tif (contrast < this.contrastThreshold) {\n\t\t\t\tchild.style.border = \"10px solid red\";\n\t\t\t\t// child.style[\"::after\"].content = `${child.className} contrast ratio is ${contrast}`;\n\t\t\t}\n\t\t\tif (contrast > this.contrastThreshold) {\n\t\t\t\tisValid = true;\n\t\t\t\tchild.style.border = \"10px solid green\";\n\t\t\t}\n\n\t\t\tconst childStyleVal = {\n\t\t\t\tclass: `${child.tagName.toLowerCase()}.${child.classList.value}`,\n\t\t\t\tbgColor: this.getEffectiveBackgroundColor(child),\n\t\t\t\tcolor: childStyle.color,\n\t\t\t\tfontSize: childStyle.fontSize,\n\t\t\t\tfontWeight: childStyle.fontWeight,\n\t\t\t\tcontrastRatio: contrast,\n\t\t\t\tisValid: isValid,\n\t\t\t};\n\n\t\t\tconsole.table(childStyleVal);\n\n\t\t\tif (child.children.length > 0) {\n\t\t\t\tthis.checkContrastForChildren(child);\n\t\t\t}\n\t\t}\n\t}\n\n\tisTransparent(color) {\n\t\tconst parsed = this.parseColor(color);\n\t\treturn parsed.a === 0 || color === \"rgba(0, 0, 0, 0)\" || color === \"transparent\";\n\t}\n\n\tcalculateContrastRatio(bgColor, textColor) {\n\t\tconst bgLuminance = this.getRelativeLuminance(this.parseColor(bgColor));\n\t\tconst textLuminance = this.getRelativeLuminance(this.parseColor(textColor));\n\n\t\tconst lighter = Math.max(bgLuminance, textLuminance);\n\t\tconst darker = Math.min(bgLuminance, textLuminance);\n\n\t\treturn (lighter + 0.05) / (darker + 0.05);\n\t}\n\n\tparseColor(color) {\n\t\tconst rgbaRegex = /rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/;\n\t\tconst match = color.match(rgbaRegex);\n\t\tif (match) {\n\t\t\treturn {\n\t\t\t\tr: parseInt(match[1], 10),\n\t\t\t\tg: parseInt(match[2], 10),\n\t\t\t\tb: parseInt(match[3], 10),\n\t\t\t\ta: match[4] ? parseFloat(match[4]) : 1,\n\t\t\t};\n\t\t}\n\t\tthrow new Error(`Invalid color format: ${color}`);\n\t}\n\n\tgetRelativeLuminance({ r, g, b }) {\n\t\tconst [rSRGB, gSRGB, bSRGB] = [r, g, b].map((c) => {\n\t\t\tc /= 255;\n\t\t\treturn c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);\n\t\t});\n\t\treturn 0.2126 * rSRGB + 0.7152 * gSRGB + 0.0722 * bSRGB;\n\t}\n}\n\nexport { ColorContrastChecker };\n"],"names":["ColorContrastChecker","containerElement","criteriaInfo","element","style","currentElement","bgColor","children","child","childStyle","contrast","isValid","isLargeFont","isBold","childStyleVal","color","textColor","bgLuminance","textLuminance","lighter","darker","rgbaRegex","match","r","g","b","rSRGB","gSRGB","bSRGB","c"],"mappings":"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"}