{"version":3,"file":"colorContrast.js","sources":["../../colorContrast.js"],"sourcesContent":["class ColorContrastChecker {\n\tconstructor(containerElement, criteriaInfo = { fontSize: \"23.994px\", fontWeight: 700, contrastThreshold: 4.5 }) {\n\t\tthis.containerElement = containerElement;\n\t\tthis.contrastThreshold = criteriaInfo.contrastThreshold;\n\t\tthis.criteriaInfo = criteriaInfo;\n\t\tif (!this.containerElement) {\n\t\t\tthrow new Error(`Container element with selector \"${containerSelector}\" not found.`);\n\t\t}\n\t}\n\n\tinit() {\n\t\tif (document.readyState === \"loading\") {\n\t\t\tdocument.addEventListener(\"DOMContentLoaded\", () => this.checkContrastForChildren());\n\t\t} else {\n\t\t\tthis.checkContrastForChildren();\n\t\t}\n\t}\n\n\tgetElementStyle(element) {\n\t\tconst style = window.getComputedStyle(element);\n\t\treturn {\n\t\t\tbgColor: style.backgroundColor,\n\t\t\tcolor: style.color,\n\t\t\tfontSize: style.fontSize,\n\t\t\tfontWeight: style.fontWeight,\n\t\t};\n\t}\n\n\tgetEffectiveBackgroundColor(element) {\n\t\tlet currentElement = element;\n\t\tlet bgColor;\n\n\t\twhile (currentElement && currentElement !== document.body) {\n\t\t\tbgColor = this.getElementStyle(currentElement).bgColor;\n\t\t\tif (!this.isTransparent(bgColor)) {\n\t\t\t\treturn bgColor;\n\t\t\t}\n\t\t\tcurrentElement = currentElement.parentElement;\n\t\t}\n\n\t\treturn this.getElementStyle(document.body).bgColor;\n\t}\n\n\tcheckContrastForChildren(element = this.containerElement) {\n\t\tconst children = element.children;\n\t\tfor (const child of children) {\n\t\t\tconst childStyle = this.getElementStyle(child);\n\t\t\tconst contrast = this.calculateContrastRatio(this.getEffectiveBackgroundColor(child), childStyle.color);\n\n\t\t\tlet isValid = false;\n\n\t\t\t// check whether the element matches the criteria or not\n\t\t\tconst isLargeFont = childStyle.fontSize <= this.criteriaInfo.fontSize;\n\t\t\tconst isBold = childStyle.fontWeight <= this.criteriaInfo.fontWeight;\n\t\t\tthis.contrastThreshold = isLargeFont && isBold ? 4.5 : 3.1;\n\n\t\t\tif (contrast < this.contrastThreshold) {\n\t\t\t\tchild.style.border = \"2px solid red\";\n\t\t\t\t// child.style[\"::after\"].content = `${child.className} contrast ratio is ${contrast}`;\n\t\t\t}\n\t\t\tif (contrast > this.contrastThreshold) {\n\t\t\t\tisValid = true;\n\t\t\t\tchild.style.border = \"2px solid green\";\n\t\t\t}\n\n\t\t\tconst childStyleVal = {\n\t\t\t\tclass: `${child.tagName.toLowerCase()}.${child.classList.value}`,\n\t\t\t\tbgColor: this.getEffectiveBackgroundColor(child),\n\t\t\t\tcolor: childStyle.color,\n\t\t\t\tfontSize: childStyle.fontSize,\n\t\t\t\tfontWeight: childStyle.fontWeight,\n\t\t\t\tcontrastRatio: contrast,\n\t\t\t\tisValid: isValid,\n\t\t\t};\n\n\t\t\tconsole.table(childStyleVal);\n\n\t\t\tif (child.children.length > 0) {\n\t\t\t\tthis.checkContrastForChildren(child);\n\t\t\t}\n\t\t}\n\t}\n\n\tisTransparent(color) {\n\t\tconst parsed = this.parseColor(color);\n\t\treturn parsed.a === 0 || color === \"rgba(0, 0, 0, 0)\" || color === \"transparent\";\n\t}\n\n\tcalculateContrastRatio(bgColor, textColor) {\n\t\tconst bgLuminance = this.getRelativeLuminance(this.parseColor(bgColor));\n\t\tconst textLuminance = this.getRelativeLuminance(this.parseColor(textColor));\n\n\t\tconst lighter = Math.max(bgLuminance, textLuminance);\n\t\tconst darker = Math.min(bgLuminance, textLuminance);\n\n\t\treturn (lighter + 0.05) / (darker + 0.05);\n\t}\n\n\tparseColor(color) {\n\t\tconst rgbaRegex = /rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*([\\d.]+))?\\)/;\n\t\tconst match = color.match(rgbaRegex);\n\t\tif (match) {\n\t\t\treturn {\n\t\t\t\tr: parseInt(match[1], 10),\n\t\t\t\tg: parseInt(match[2], 10),\n\t\t\t\tb: parseInt(match[3], 10),\n\t\t\t\ta: match[4] ? parseFloat(match[4]) : 1,\n\t\t\t};\n\t\t}\n\t\tthrow new Error(`Invalid color format: ${color}`);\n\t}\n\n\tgetRelativeLuminance({ r, g, b }) {\n\t\tconst [rSRGB, gSRGB, bSRGB] = [r, g, b].map((c) => {\n\t\t\tc /= 255;\n\t\t\treturn c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);\n\t\t});\n\t\treturn 0.2126 * rSRGB + 0.7152 * gSRGB + 0.0722 * bSRGB;\n\t}\n}\n\nexport { ColorContrastChecker };\n"],"names":["ColorContrastChecker","containerElement","criteriaInfo","element","style","currentElement","bgColor","children","child","childStyle","contrast","isValid","isLargeFont","isBold","childStyleVal","color","textColor","bgLuminance","textLuminance","lighter","darker","rgbaRegex","match","r","g","b","rSRGB","gSRGB","bSRGB","c"],"mappings":"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"}